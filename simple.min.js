// Simple.js 0.1.1
// http://simplejs.org

// A simplistic MV* JavaScript library.
// Simple may be freely distributed under the MIT license.
// (c) 2012 Kim Joar Bekkelund
(function(e,t){var n=e.Simple={},r=n.Events={on:function(e,t,n){var r=this._callbacks||(this._callbacks={}),i=r[e]||(r[e]=[]);i.push({callback:t,context:n})},off:function(e,t,n){!t&&!n&&delete this._callbacks[e];var r=this._callbacks[e]||[];for(var i=0;i<r.length;i++)t&&r[i].callback!==t||n&&r[i].context!==n||r.splice(i,1)},trigger:function(e){var t=Array.prototype.slice.call(arguments,1),n=this._callbacks||{},r=n[e]||[];for(i=0;i<r.length;i++)r[i].callback.apply(r[i].context||this,t)}};n.events=t.extend({},r);var s=n.View=function(e){this.el=e.el,this.delegateEvents(),this.initialize(e)};t.extend(s.prototype,r,{initialize:function(){},render:function(){},DOM:function(e){return this.el.find(e)},delegateEvents:function(){if(!this.events)return;for(var e in this.events){var n=this.events[e],r=t.proxy(this[n],this),i=e.match(/^(\w+)(:?\s+(.*))?$/),s=i[1],o=i[2];this.el.on(s,o,r)}}});var o=n.Model=function(e){this.attributes=e||{},this.initialize(e)};t.extend(o.prototype,r,{initialize:function(){},fetch:function(e){this._performRequest("fetch",this,e||{},{})},save:function(e){this._performRequest("save",this,e||{},{type:"POST",data:JSON.stringify(this.attributes),contentType:"application/json"})},_performRequest:function(e,n,r,i){this.trigger(e+":started");var s={url:typeof n.url=="function"?n.url():n.url,dataType:r.dataType||n.dataType||"json",success:function(t){n.attrs(t),typeof r.success!="undefined"?r.success(t):n.trigger(e+":finished")},error:function(t,i){typeof r.error!="undefined"?r.error():n.trigger(e+":error",i)}};t.ajax(t.extend(s,i))},attr:function(e,t){if(typeof t=="undefined")return this.attributes[e];this.attributes[e]=t},attrs:function(e){if(typeof e=="undefined")return t.extend({},this.attributes);t.extend(this.attributes,e)}});var u=function(){};s.extend=o.extend=function(e){var n=this,r=function(){n.apply(this,arguments)};return u.prototype=n.prototype,r.prototype=new u,t.extend(r.prototype,e),r.extend=n.extend,r}})(this,jQuery);
