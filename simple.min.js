//     Simple.js 0.1.1
//
//     A simplistic MV* JavaScript library.
//     Simple may be freely distributed under the MIT license.
//
//     Created by Kim Joar Bekkelund <mail@kimjoar.net>
//
// The primary function of *Simple.js* is to create simple abstractions for
// models and views. It aims to be a JavaScript MV* library which is both easy
// to understand and easy to extend.
//
// Simple.js is (currently) 120 [thoroughly tested](https://github.com/kjbekkelund/simple/blob/master/spec/simple-spec.js)
// lines of code. The project is [hosted on Github](https://github.com/kjbekkelund/simple),
// where you can also find the [changelog](https://github.com/kjbekkelund/simple/blob/master/CHANGELOG.md).
//
// Simple.js depends on [jQuery](http://jquery.com/) 1.7.0. Remember to include
// it before you include Simple.js itself.
//
// This library is heavily inspired by [Backbone.js](http://backbonejs.org/)
// and [Spine.js](http://spinejs.com/).
(function(e,t){var n=e.Simple={},r=n.Events={on:function(e,t,n){var r=this._callbacks||(this._callbacks={}),i=r[e]||(r[e]=[]);i.push({callback:t,context:n})},off:function(e,t,n){!t&&!n&&delete this._callbacks[e];var r=this._callbacks[e]||[];for(var i=0;i<r.length;i++)t&&r[i].callback!==t||n&&r[i].context!==n||r.splice(i,1)},trigger:function(e){var t=Array.prototype.slice.call(arguments,1),n=this._callbacks||{},r=n[e]||[];for(var i=0;i<r.length;i++)r[i].callback.apply(r[i].context||this,t)}};n.events=t.extend({},r);var i=n.View=function(e){this.el=e.el,this.delegateEvents(),this.initialize(e)};t.extend(i.prototype,r,{initialize:function(){},render:function(){},DOM:function(e){return this.el.find(e)},delegateEvents:function(){if(!this.events)return;for(var e in this.events){var n=this.events[e],r=t.proxy(this[n],this),i=e.match(/^(\w+)(:?\s+(.*))?$/),s=i[1],o=i[2];this.el.on(s,o,r)}}});var s=n.Model=function(e){this.attributes=this.defaults||{},this.attrs(e||{}),this.initialize(e)};t.extend(s.prototype,r,{initialize:function(){},fetch:function(e){this._performRequest("fetch",this,e||{},{})},save:function(e){this._performRequest("save",this,e||{},{type:"POST",data:JSON.stringify(this.attributes),contentType:"application/json"})},_performRequest:function(e,n,r,i){this.trigger(e+":started");var s={url:typeof n.url=="function"?n.url():n.url,dataType:r.dataType||n.dataType||"json",success:function(t){n.attrs(t),typeof r.success!="undefined"?r.success(t):n.trigger(e+":finished")},error:function(t,i){typeof r.error!="undefined"?r.error():n.trigger(e+":error",i)}};t.ajax(t.extend(s,i))},attr:function(e,t){if(typeof t=="undefined")return this.attributes[e];this.attributes[e]=t},attrs:function(e){if(typeof e=="undefined")return t.extend({},this.attributes);t.extend(this.attributes,e)}});var o=function(){};i.extend=s.extend=function(e){var n=this,r=function(){n.apply(this,arguments)};return o.prototype=n.prototype,r.prototype=new o,t.extend(r.prototype,e),r.extend=n.extend,r}})(this,jQuery);